import{a as d,b as y,m as S,n as g,r as i,c as b,j as u,M as w,e as c,l as p,p as x,A as q,d as I}from"./index-nLGxCEPz.js";const k=async(n,t,r,s)=>{try{r&&(t.headers={...t.headers,Authorization:`${r}`}),t.signal=d.signal,s&&(t.responseType=s);const e=await y(n,t),o=e.headers["content-type"];if(e.status!==200)return null;if(e.data.code===401){S.error(e.data.message),localStorage.clear(),await d.abort(),g(),setTimeout(()=>{window.location.href="/login"},1e3);return}if(o.includes("application/json")||o.includes("text/plain")){if(e.data.code!==200)throw e.data.msg||e.data.message?e.data.msg||e.data.message:null;return e.data}else return e}catch(e){throw e}},T=n=>{const{url:t,data:r,token:s,responseType:e}=n;return k(t,{data:r,method:"POST"},s,e)};function C(){const[n,t]=i.useState([]),r=b(a=>a.user.token),[s,e]=i.useState(),[o,h]=i.useState("");function m(){c(1,t),T({url:I,token:r}).then(a=>{if(a){const l=a.content;l.isSend&&l.isSend==="是"?l.isSend=!0:l.isSend=!1,e(l),h(l.id)}}).finally(()=>{p(1,t)})}i.useEffect(()=>{m()},[]);function f(a){c(0,t),x({url:q,token:r,data:{...a,id:o}}).finally(()=>{p(0,t)})}return u.jsx("div",{style:{margin:"20px"},children:u.jsx(w,{labelWidth:120,initialValues:s,fields:[{type:"input",name:"tenantId",label:"租户ID",required:!0,placeholder:"请输入租户ID"},{type:"input",name:"secret",label:"秘钥",required:!0,placeholder:"请输入秘钥"},{type:"input",name:"tokenUrl",label:"三方接口地址",required:!0,placeholder:"请输入三方接口获取tokenURL地址"},{type:"input",name:"sendUrl",label:"短信发送接口",required:!0,placeholder:"请输入发送短信接口"},{type:"input",name:"overageUrl",label:"余额查询地址",required:!0,placeholder:"请输入余额查询地址"},{type:"input",name:"username",label:"短信平台账号",required:!0,placeholder:"请输入短信平台账号"},{type:"input",name:"password",label:"短信平台密码",required:!0,placeholder:"请输入短信平台密码"},{type:"input",name:"userId",label:"短信平台企业ID",required:!0,placeholder:"请输入短信平台企业ID"},{type:"input",name:"whUrl",label:"问卷地址",required:!0,placeholder:"请输入问卷地址"},{type:"switch",required:!0,name:"isSend",label:"开启短信发送",checkedText:"开启",uncheckedText:"关闭"}],showOk:!0,okText:"保存配置",okLoading:n[1]||n[0],footerButtonStyle:"full",footerDirection:"vertical",onFinish:a=>{a.isSend===!1?a.isSend="否":a.isSend="是",f(a)}},o)})}export{C as default};
